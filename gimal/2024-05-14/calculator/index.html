<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>계산기</title>
    <style>
        * { box-sizing: border-box }
        #result { width: 180px; height: 50px; margin: 5px; text-align: right } 
        #operator { width: 50px; height: 50px; margin: 5px; text-align: center } 
        button { width: 50px; height: 50px; margin: 5px }
    </style>
</head>
<body>
    <input readonly="" id="operator">
    <input readonly="" type="number" id="result">
    <div class="row">
        <button id="num-7">7</button>
        <button id="num-8">8</button>
        <button id="num-9">9</button>
        <button id="plus">+</button>
    </div>
    <div class="row">
        <button id="num-4">4</button>
        <button id="num-5">5</button>
        <button id="num-6">6</button>
        <button id="minus">-</button>
    </div>
    <div class="row">
        <button id="num-1">1</button>
        <button id="num-2">2</button>
        <button id="num-3">3</button>
        <button id="divide">/</button>
    </div>
    <div class="row">
        <button id="clear">C</button>
        <button id="num-0">0</button>
        <button id="calculate">=</button>
        <button id="multiply">x</button>
    </div>
    <script>
        // 계산기의 현재 입력값을 저장하는 변수
        let currentInput = ''; 
        // 이전 계산 결과를 저장하는 변수
        let previousResult = 0; 
        // 현재 연산자를 저장하는 변수
        let currentOperator = null; 
        // 연산자와 결과를 표시하는 DOM 요소들을 가져옴
        const $operator = document.querySelector('#operator'); 
        const $result = document.querySelector('#result');

        // 계산을 수행하는 함수
        const calculate = () => {
            let numTwo = parseFloat(currentInput);
            switch (currentOperator) {
                case '+':
                    previousResult += numTwo;
                    break;
                case '-':
                    previousResult -= numTwo;
                    break;
                case '*':
                    previousResult *= numTwo;
                    break;
                case '/':
                    previousResult /= numTwo;
                    break;
                default:
                    return;
            }
        };

        // 숫자 버튼 클릭 시 호출되는 함수
        const onClickNumber = (event) => {
            currentInput += event.target.textContent;
            $result.value = currentInput;
        };

        // 모든 숫자 버튼에 클릭 이벤트 리스너를 추가
        document.querySelectorAll('.row button').forEach(button => {
            if (!button.id.startsWith('num')) return;
            button.addEventListener('click', onClickNumber);
        });

        // 연산자 버튼 클릭 시 호출되는 함수
        const onClickOperator = (op) => () => {
            if (!currentInput && op === '-') { // 음수 입력 허용
                currentInput = '-';
                $result.value = '-';
                return;
            }

            if (currentOperator && currentInput) {
                calculate();
                $result.value = previousResult; // 이전 계산 결과를 표시
            } else if (!previousResult) {
                previousResult = parseFloat(currentInput);
            }

            currentInput = '';
            currentOperator = op;
            $operator.value = op;
            $result.value = previousResult.toString(); // 마지막 입력값을 계속 표시
        };

        // 연산자 버튼들에 클릭 이벤트 리스너를 추가
        document.querySelector('#plus').addEventListener('click', onClickOperator('+'));
        document.querySelector('#minus').addEventListener('click', onClickOperator('-'));
        document.querySelector('#divide').addEventListener('click', onClickOperator('/'));
        document.querySelector('#multiply').addEventListener('click', onClickOperator('*'));

        // '=' 버튼 클릭 시 호출되는 함수
        document.querySelector('#calculate').addEventListener('click', () => {
            if (currentInput) {
                calculate();
            }
            $result.value = previousResult;
            currentInput = '';
            currentOperator = null;
            previousResult = 0;  // 계산 후 초기화
        });

        // 'C' 버튼 클릭 시 호출되는 함수
        document.querySelector('#clear').addEventListener('click', () => {
            currentInput = '';
            previousResult = 0;
            currentOperator = null;
            $operator.value = '';
            $result.value = '0';
        });

    </script>
</body>
</html>

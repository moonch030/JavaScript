<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>계산기</title>
    <style>
        * { box-sizing: border-box }
        #result { width: 180px; height: 50px; margin: 5px; text-align: right } 
        #operator { width: 50px; height: 50px; margin: 5px; text-align: center } 
        button { width: 50px; height: 50px; margin: 5px }
    </style>
</head>
<body>
    <input readonly="" id="operator">
    <input readonly="" type="number" id="result">
    <div class="row">
        <button id="num-7">7</button>
        <button id="num-8">8</button>
        <button id="num-9">9</button>
        <button id="plus">+</button>
    </div>
    <div class="row">
        <button id="num-4">4</button>
        <button id="num-5">5</button>
        <button id="num-6">6</button>
        <button id="minus">-</button>
    </div>
    <div class="row">
        <button id="num-1">1</button>
        <button id="num-2">2</button>
        <button id="num-3">3</button>
        <button id="divide">/</button>
    </div>
    <div class="row">
        <button id="clear">C</button>
        <button id="num-0">0</button>
        <button id="calculate">=</button>
        <button id="multiply">x</button>
    </div>
    <script>
        let currentInput = ''; 
        let previousResult = 0; 
        let currentOperator = null; 
        const $operator = document.querySelector('#operator'); 
        const $result = document.querySelector('#result');

        const calculate = () => {
            let numTwo = parseFloat(currentInput);
            switch (currentOperator) {
                case '+':
                    previousResult += numTwo;
                    break;
                case '-':
                    previousResult -= numTwo;
                    break;
                case '*':
                    previousResult *= numTwo;
                    break;
                case '/':
                    previousResult /= numTwo;
                    break;
                default:
                    return;
            }
        };

        const onClickNumber = (event) => {
            currentInput += event.target.textContent;
            $result.value = currentInput;
        };

        document.querySelectorAll('.row button').forEach(button => {
            if (!button.id.startsWith('num')) return;
            button.addEventListener('click', onClickNumber);
        });

        const onClickOperator = (op) => () => {
            if (!currentInput && op === '-') { // Allow negative numbers
                currentInput = '-';
                $result.value = '-';
                return;
            }

            if (currentOperator && currentInput) {
                calculate();
                $result.value = previousResult; // Show result of previous calculation
            } else if (!previousResult) {
                previousResult = parseFloat(currentInput);
            }

            currentInput = '';
            currentOperator = op;
            $operator.value = op;
            $result.value = previousResult.toString(); // Continue showing the last input instead of '0'
        };

        document.querySelector('#plus').addEventListener('click', onClickOperator('+'));
        document.querySelector('#minus').addEventListener('click', onClickOperator('-'));
        document.querySelector('#divide').addEventListener('click', onClickOperator('/'));
        document.querySelector('#multiply').addEventListener('click', onClickOperator('*'));

        document.querySelector('#calculate').addEventListener('click', () => {
            if (currentInput) {
                calculate();
            }
            $result.value = previousResult;
            currentInput = '';
            currentOperator = null;
            previousResult = 0;  // Reset after calculation
        });

        document.querySelector('#clear').addEventListener('click', () => {
            currentInput = '';
            previousResult = 0;
            currentOperator = null;
            $operator.value = '';
            $result.value = '0';
        });

    </script>
    
</body>
</html>
